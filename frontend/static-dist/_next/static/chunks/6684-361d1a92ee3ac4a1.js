"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6684],{69658:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(39763).Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])},41473:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(39763).Z)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]])},7586:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(39763).Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]])},99397:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(39763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},17689:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(39763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},56684:function(e,t,l){var a=l(57437),s=l(2265),r=l(69658),n=l(32489),i=l(56475),c=l(17689),o=l(73247),d=l(41473),u=l(7586),h=l(99397),g=l(90486),x=l(68328),m=l(46427);t.Z=e=>{let{isOpen:t,onClose:l,onSelect:f,multiple:p=!1,acceptedTypes:b=["image","document"],selectedFiles:y=[],title:v="Select Media"}=e,[j,N]=(0,s.useState)([]),[w,k]=(0,s.useState)(!1),[C,Z]=(0,s.useState)(!1),[S,M]=(0,s.useState)(y.map(e=>e.id)),[F,U]=(0,s.useState)(""),[D,E]=(0,s.useState)("all"),[L,T]=(0,s.useState)("all"),[A,z]=(0,s.useState)("grid"),[q,B]=(0,s.useState)([]),[_,H]=(0,s.useState)("library"),[Q,W]=(0,s.useState)(!1),G=(0,s.useCallback)(async()=>{try{let e=await g.Z.getMediaCategories();e.success&&B(e.data||[])}catch(e){console.error("Failed to fetch categories:",e)}},[]),I=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||e)try{k(!0);let e={limit:50};"all"!==D&&(e.category=D),"all"!==L&&(e.type=L);let t=await g.Z.getMediaFiles(e);if(t.success){let e=t.data||[];e=e.filter(e=>b.includes(e.type)),F.trim()&&(e=e.filter(e=>e.originalName.toLowerCase().includes(F.toLowerCase())||e.filename&&e.filename.toLowerCase().includes(F.toLowerCase()))),N(e)}}catch(e){console.error("Failed to fetch media files:",e)}finally{k(!1)}},[]);(0,s.useEffect)(()=>{t&&(G(),I(!0))},[t,G]),(0,s.useEffect)(()=>{if(!t)return;let e=setTimeout(()=>{I(!0)},300);return()=>clearTimeout(e)},[F,D,L]);let P=async e=>{if(e&&0!==e.length)try{Z(!0);let l="all"===D?"general":D,a=[],s=[];for(let t=0;t<e.length;t++){let l=e[t];(0,m.ng)(l,10)?(0,m.DS)(l)?a.push(l):s.push("".concat(l.name," (unsupported file type)")):s.push("".concat(l.name," (file too large)"))}if(s.length>0&&x.A.warning("Some files were skipped: ".concat(s.join(", "))),0===a.length){x.A.error("No valid files to upload");return}let r=new DataTransfer;a.forEach(e=>r.items.add(e));let n=r.files,i=await g.Z.uploadMedia(n,l);if(i.success){var t;x.A.success("".concat((null===(t=i.data)||void 0===t?void 0:t.length)||a.length," file(s) uploaded successfully!")),await I(!0),H("library")}else throw Error(i.message||"Upload failed")}catch(e){console.error("Upload failed:",e),x.A.error("Upload failed: ".concat(e.message||"Please try again"))}finally{Z(!1)}},K=e=>{p?M(t=>t.includes(e.id)?t.filter(t=>t!==e.id):[...t,e.id]):M([e.id])},O=e=>{let{src:t,alt:l,className:n,fallbackSrc:i}=e,[c,o]=(0,s.useState)(t),[d,u]=(0,s.useState)(!1);return d&&(!i||c===i)?(0,a.jsx)("div",{className:"".concat(n," flex items-center justify-center bg-gray-100"),children:(0,a.jsx)(r.Z,{className:"w-8 h-8 text-gray-400"})}):(0,a.jsx)("img",{src:c,alt:l,className:n,onError:()=>{!d&&i&&c!==i&&o(i),u(!0)},loading:"lazy"})};return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:l}),(0,a.jsxs)("div",{className:"absolute inset-4 bg-white rounded-lg shadow-2xl flex flex-col max-h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:v}),(0,a.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-full",children:(0,a.jsx)(n.Z,{className:"w-6 h-6"})})]}),(0,a.jsxs)("div",{className:"flex border-b",children:[(0,a.jsxs)("button",{onClick:()=>H("library"),className:"px-6 py-3 font-medium ".concat("library"===_?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 inline-block mr-2"}),"Media Library"]}),(0,a.jsxs)("button",{onClick:()=>H("upload"),className:"px-6 py-3 font-medium ".concat("upload"===_?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 inline-block mr-2"}),"Upload Files"]})]}),(0,a.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:"library"===_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-4 border-b bg-gray-50",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)("div",{className:"relative flex-1 min-w-64",children:[(0,a.jsx)(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)("input",{type:"text",placeholder:"Search files...",value:F,onChange:e=>U(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full"})]}),(0,a.jsxs)("select",{value:D,onChange:e=>E(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Categories"}),q.map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,a.jsxs)("select",{value:L,onChange:e=>T(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Types"}),(0,a.jsx)("option",{value:"image",children:"Images"}),(0,a.jsx)("option",{value:"document",children:"Documents"})]}),(0,a.jsxs)("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden",children:[(0,a.jsx)("button",{onClick:()=>z("grid"),className:"p-2 ".concat("grid"===A?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"),children:(0,a.jsx)(d.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>z("list"),className:"p-2 ".concat("list"===A?"bg-blue-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"),children:(0,a.jsx)(u.Z,{className:"w-4 h-4"})})]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-4",children:w?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):0===j.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[(0,a.jsx)(i.Z,{className:"w-16 h-16 mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"No files found"}),(0,a.jsx)("p",{children:"Upload some files to get started"})]}):"grid"===A?(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:j.map(e=>(0,a.jsxs)("div",{onClick:()=>K(e),className:"relative cursor-pointer rounded-lg border-2 transition-all ".concat(S.includes(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsx)("div",{className:"aspect-square p-2",children:"image"===e.type?(0,a.jsx)(O,{src:(0,m.Q8)(e.thumbnailUrl||e.url),alt:e.originalName,className:"w-full h-full object-cover rounded",fallbackSrc:(0,m.Q8)(e.url)}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 rounded",children:(0,a.jsx)(r.Z,{className:"w-8 h-8 text-gray-400"})})}),(0,a.jsxs)("div",{className:"p-2 border-t",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-900 truncate",children:e.originalName}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(0,m.sS)(e.size)})]}),S.includes(e.id)&&(0,a.jsx)("div",{className:"absolute top-2 right-2 bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs",children:"✓"})})]},e.id))}):(0,a.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,a.jsxs)("div",{onClick:()=>K(e),className:"flex items-center p-3 rounded-lg border cursor-pointer transition-all ".concat(S.includes(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded overflow-hidden mr-3",children:"image"===e.type?(0,a.jsx)("img",{src:e.thumbnailUrl||e.url,alt:e.originalName,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:(0,a.jsx)(r.Z,{className:"w-6 h-6 text-gray-400"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.originalName}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,m.sS)(e.size)," • ",e.category,e.dimensions&&" • ".concat(e.dimensions.width,"\xd7").concat(e.dimensions.height)]})]}),S.includes(e.id)&&(0,a.jsx)("div",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center ml-3",children:(0,a.jsx)("span",{className:"text-xs",children:"✓"})})]},e.id))})})]}):(0,a.jsx)("div",{className:"flex-1 p-6",children:(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),W(!0)},onDragLeave:e=>{e.preventDefault(),W(!1)},onDrop:e=>{e.preventDefault(),W(!1);let t=e.dataTransfer.files;t&&P(t)},className:"border-2 border-dashed rounded-lg p-12 text-center transition-colors ".concat(Q?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),children:[(0,a.jsx)(c.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:C?"Uploading...":"Upload Files"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Drag and drop files here, or click to select files"}),(0,a.jsx)("input",{type:"file",multiple:!0,onChange:e=>e.target.files&&P(e.target.files),className:"hidden",id:"file-upload",accept:b.includes("image")?"image/*":void 0}),(0,a.jsxs)("label",{htmlFor:"file-upload",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Select Files"]}),C&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse"})})})]})})}),(0,a.jsxs)("div",{className:"p-6 border-t bg-gray-50 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:S.length>0&&(0,a.jsxs)("span",{children:[S.length," file",S.length>1?"s":""," selected"]})}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:l,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{let e=j.filter(e=>S.includes(e.id));e.length>0&&(f(p?e:e[0]),l())},disabled:0===S.length,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Select Files":"Select File"})]})]})]})]}):null}},46427:function(e,t,l){l.d(t,{DS:function(){return i},Q8:function(){return n},ng:function(){return o},sS:function(){return c}});let a=()=>"http://localhost:5000/api",s=()=>a().replace("/api",""),r=e=>{if(e.startsWith("http")){if(e.includes("/uploads/")){let t=e.split("/uploads/")[1].split("/");if(t.length>1){let e=t[0],l=t.slice(1).join("/");return"".concat(s(),"/api/media/serve/").concat(e,"/").concat(l)}{let e=t[0];return"".concat(s(),"/api/media/serve/general/").concat(e)}}return e}if(e.startsWith("/api/media/serve"))return"".concat(s()).concat(e);if(e.startsWith("/uploads/")){let t=e.substring(9).split("/");if(t.length>1){let e=t[0],l=t.slice(1).join("/");return"".concat(s(),"/api/media/serve/").concat(e,"/").concat(l)}{let e=t[0];return"".concat(s(),"/api/media/serve/general/").concat(e)}}return e},n=(e,t)=>{try{return r(e)}catch(l){return console.warn("Invalid image URL:",e),t||"/placeholder-image.png"}},i=e=>["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type),c=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e.size<=1048576*t}},68328:function(e,t,l){l.d(t,{A:function(){return s}});class a{createContainer(){return this.container||(this.container=document.createElement("div"),this.container.id="toast-container",this.container.className="fixed top-4 right-4 z-50 space-y-2",document.body.appendChild(this.container)),this.container}show(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{type:l="info",duration:a=4e3,position:s="top-right"}=t,r=this.createContainer(),n="toast-".concat(++this.toastCount),i=document.createElement("div");i.id=n,i.className="\n      transform transition-all duration-300 ease-in-out\n      max-w-sm w-full shadow-lg rounded-lg pointer-events-auto\n      overflow-hidden ring-1 ring-black ring-opacity-5\n      ".concat("success"===l?"bg-green-50 border-green-200":"","\n      ").concat("error"===l?"bg-red-50 border-red-200":"","\n      ").concat("warning"===l?"bg-yellow-50 border-yellow-200":"","\n      ").concat("info"===l?"bg-blue-50 border-blue-200":"","\n      translate-x-full opacity-0\n    ");let c={success:"text-green-800",error:"text-red-800",warning:"text-yellow-800",info:"text-blue-800"};i.innerHTML='\n      <div class="p-4">\n        <div class="flex items-start">\n          <div class="flex-shrink-0">\n            <span class="text-lg '.concat(c[l],'">').concat({success:"✓",error:"✕",warning:"⚠",info:"ℹ"}[l],'</span>\n          </div>\n          <div class="ml-3 w-0 flex-1">\n            <p class="text-sm font-medium ').concat(c[l],'">').concat(e,'</p>\n          </div>\n          <div class="ml-4 flex-shrink-0 flex">\n            <button class="rounded-md inline-flex ').concat(c[l]," hover:").concat(c[l],' focus:outline-none" onclick="this.closest(\'[id^=toast-]\').remove()">\n              <span class="sr-only">Close</span>\n              <span class="text-sm">\xd7</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    '),r.appendChild(i),setTimeout(()=>{i.className=i.className.replace("translate-x-full opacity-0","translate-x-0 opacity-100")},10),setTimeout(()=>{i.parentElement&&(i.className=i.className.replace("translate-x-0 opacity-100","translate-x-full opacity-0"),setTimeout(()=>{i.parentElement&&i.remove()},300))},a)}success(e,t){this.show(e,{type:"success",duration:t})}error(e,t){this.show(e,{type:"error",duration:t})}warning(e,t){this.show(e,{type:"warning",duration:t})}info(e,t){this.show(e,{type:"info",duration:t})}constructor(){this.container=null,this.toastCount=0}}let s=new a}}]);